=== VaultBox Progress ===
Last updated: 2026-02-09
Last completed feature: F16 — ViewModels (AuthViewModel, VaultViewModel, AlbumViewModel, ImportViewModel)
Current status: compiles, all tests passing
Next feature: F17 — Paywall / monetization
Blockers: none
Notes: AuthService is @MainActor class (not actor) because ModelContext isn't Sendable. KeyStorage protocol enables InMemoryKeyStorage for tests. Use @preconcurrency import for KeychainAccess. PINDotsView extracted as reusable component with normal/success/error states. Use 'iPhone 17 Pro' simulator. Added pinLength to AppSettings and getPINLength()/isBiometricsEnabled() helpers to AuthService. LockScreenView auto-verifies on last digit, supports lockout countdown and biometric auto-prompt. VaultService is @MainActor @Observable (same pattern as AuthService). Uses continuation-based wrappers for NSItemProvider async loading. Video imports use AVAssetImageGenerator for thumbnail from first frame. Documents have no thumbnail. VaultError enum with 5 cases. Stats methods use fetchCount/fetch+reduce for storage. VaultGridView uses @Query for reactive SwiftData fetching, computed property for filtering/sorting, @State thumbnail cache with async decryption via .task, VaultSortOrder/VaultFilter enums. Erasing simulator data fixes CoreData migration errors from schema changes. PhotoDetailView uses fullScreenCover from VaultGridView, TabView with .page style for swipe navigation, ZoomScrollView for pinch zoom up to 5x and double-tap 1x/2x. Video items show thumbnail with play button overlay. VideoPlayerView decrypts to temp file, plays with AVPlayerViewController, cleans up on disappear. AlbumGridView uses 2-column grid, "All Items" card always first, user albums with context menu (Rename, Delete), + button creates via alert. AlbumDetailView shows album items in 3-column grid with sort/filter, navigates to PhotoDetailView. Album delete has two options: delete album only (items move to All Items) or delete album and contents. Cover thumbnails loaded async from cover item or first item. F13: VaultService.importPhotos returns ImportResult with items and assetIdentifiers for Camera Roll deletion. F14: VaultGridView has selection mode with bottom toolbar (Move, Favorite, Delete) using safeAreaInset, batch operations via VaultService. F15: ContentView is auth gate (PINSetupView → LockScreenView → TabView), ImportView uses PhotosPicker inline with progress overlay and Camera Roll delete prompt, VideoTransferable for video import. F16: ViewModels are thin @MainActor @Observable wrappers — AuthViewModel wraps AuthService, VaultViewModel manages selection state, AlbumViewModel handles create/rename/delete/cover loading, ImportViewModel manages import flow state.
